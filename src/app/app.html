<div class="container">
  <!-- Header Component -->
  <app-header (infoClicked)="toggleFeaturesModal()"></app-header>

  <!-- Main Content -->
  <main class="flex flex-col gap-8">
    <!-- Input Section - Only on home route -->
    @if (!isResultsView()) {
    <app-input-section [curlInput]="curlInput()" [curlCount]="curlCount()" (curlInputChange)="curlInput.set($event)"
      (clearClicked)="clear()" (processClicked)="convert()"></app-input-section>
    }

    <!-- Output Section - Only on results route -->
    @if (isResultsView() && showOutput()) {
    <section class="card animate-fadeIn">
      <div class="flex justify-between items-center mb-6 flex-wrap-mobile gap-4">
        <div class="flex items-center gap-4">
          <h2 class="text-2xl font-semibold text-gray-100">ğŸ“¤ Output</h2>
          <app-format-selector [formats]="availableFormats()" [selectedFormatId]="selectedFormatId()"
            (formatChanged)="selectFormat($event)"></app-format-selector>
        </div>
        <div class="flex gap-3 flex-wrap-mobile">
          <button (click)="copyToClipboard()" class="btn btn-secondary">
            <span>ğŸ“‹</span>
            Copy JSON
          </button>
          <button (click)="download()" class="btn btn-primary">
            <span>ğŸ’¾</span>
            Download
          </button>
          <button (click)="newConversion()" class="btn btn-secondary">
            <span>â†</span>
            New Conversion
          </button>
        </div>
      </div>

      <div class="tabs">
        <button (click)="switchTab('summary')" [class.active]="currentTab() === 'summary'" class="tab">
          Summary
        </button>
        <button (click)="switchTab('collection')" [class.active]="currentTab() === 'collection'" class="tab">
          {{ currentFormat()?.name || 'Output' }}
        </button>
        <button (click)="switchTab('environment')" [class.active]="currentTab() === 'environment'" class="tab">
          Environments
        </button>
        <button (click)="switchTab('variables')" [class.active]="currentTab() === 'variables'" class="tab">
          Detected Variables
        </button>
      </div>

      <!-- Tab Content -->
      @if (currentTab() === 'summary') {
      <app-summary-tab [summaryData]="getSummaryData()" [editableRequestNames]="editableRequestNames()"
        [editableEnvNames]="editableEnvNames()" (requestNameChanged)="updateRequestName($event.index, $event.name)"
        (envNameChanged)="updateEnvironmentName($event.oldName, $event.newName)"></app-summary-tab>
      }

      @if (currentTab() === 'collection') {
      <app-output-viewer-tab [content]="outputJson()"></app-output-viewer-tab>
      }

      @if (currentTab() === 'environment') {
      <app-additional-files-tab [files]="currentAdditionalFiles()"></app-additional-files-tab>
      }

      @if (currentTab() === 'variables') {
      <app-variables-tab [hostVariables]="getHostVariablesList()"
        [tokenVariables]="getTokenVariablesList()"></app-variables-tab>
      }
    </section>
    }
  </main>

  <!-- Features Modal Component -->
  <app-modal [show]="showFeaturesModal()" [title]="'â„¹ï¸ Features'" (closeClicked)="toggleFeaturesModal()">
    <ul class="feature-list">
      <li class="feature-item">
        âœ… Automatically detects repeated hosts and creates variables
      </li>
      <li class="feature-item">
        âœ… Identifies authentication tokens and generates environment variables
      </li>
      <li class="feature-item">
        âœ… Creates separate environments for localhost and remote domains
      </li>
      <li class="feature-item">
        âœ… Generates collections compatible with Postman Collection v2.1
      </li>
      <li class="feature-item">
        âœ… Supports multiple cURL commands in a single conversion
      </li>
      <li class="feature-item">
        âœ… Smart request naming based on HTTP method and endpoint
      </li>
      <li class="feature-item">
        âœ… Editable request and environment names
      </li>
      <li class="feature-item">
        âœ… Separate protocol and host variables for flexibility
      </li>
      <li class="feature-item">
        âœ… Export to multiple formats (Postman, OpenAPI 3.0, Swagger 2.0)
      </li>
    </ul>
  </app-modal>

  <!-- Toast Component -->
  <app-toast [message]="toastMessage()" [type]="toastType()" [show]="showToast()"></app-toast>
</div>